<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>≈†koln√≠ Rozvrh - Re√°ln√Ω ƒåas [VARIANTA B]</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #0f0c29, #302b63, #24243e);
            min-height: 100vh;
            color: white;
            padding: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .container {
            max-width: 450px;
            width: 100%;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            
        }

        

        .clock-container {
            background: rgba(255, 255, 255, 0.1);
             
            border-radius: 20px;
            padding: 40px 20px;
            margin-bottom: 20px;
            border: 2px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }

        .time {
            font-size: 4rem;
            font-weight: bold;
            text-align: center;
            color: #00ffff;
            letter-spacing: 5px;
            margin-bottom: 15px;
            will-change: contents;
        }

        .date {
            text-align: center;
            font-size: 1.3rem;
            color: #b8b8ff;
        }

        .lesson-box {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 20px;
            border: 2px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            text-align: center;
            min-height: 120px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            transition: border-color 0.3s ease;
            will-change: border-color;
        }

        .lesson-name {
            font-size: 2.5rem;
            font-weight: bold;
            color: #00ffff;
            margin-bottom: 10px;
            
        }

        .lesson-time {
            font-size: 1.2rem;
            color: #ffaa00;
            font-weight: bold;
        }

        .no-lesson {
            font-size: 1.5rem;
            color: #888;
        }

        .performance-mode {
            position: fixed;
            bottom: 10px;
            right: 10px;
            background: rgba(0, 0, 0, 0.5);
            padding: 5px 10px;
            border-radius: 5px;
            font-size: 0.7rem;
            color: #0f0;
        }

        @media (max-width: 480px) {
            .time {
                font-size: 3rem;
                letter-spacing: 3px;
            }
            .lesson-name {
                font-size: 2rem;
            }
            .lesson-time {
                font-size: 1rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üéì ≈†KOLN√ç ROZVRH üéì</h1>
        </div>

        <div class="clock-container">
            <div class="time" id="time">00:00:00</div>
            <div class="date" id="date">Naƒç√≠t√°n√≠...</div>
        </div>

        <div class="lesson-box" id="lessonBox">
            <div class="no-lesson">üìÖ ≈Ω√°dn√° hodina</div>
        </div>
    </div>

    <div class="performance-mode" id="perfMode">‚ö° VARIANTA B</div>
     <script src="rozvrh-hodin.js"></script>   
    <script>
        // ============================================
        // ‚ö° VARIANTA B - MAXIM√ÅLN√ç OPTIMALIZACE ‚ö°
        // ============================================
        
       /* // ROZVRH - norm√°lnƒõ by byl v extern√≠m souboru rozvrh-hodin.js
        const schedule = [
            // PONDƒöL√ç (day: 1)
            { day: 1, timeFrom: '08:00', timeTo: '15:15', subject: 'Ov', color: '#00bfff' },
            
            // √öTER√ù (day: 2)
            { day: 2, timeFrom: '08:00', timeTo: '15:15', subject: 'Ov', color: '#00bfff' },
            
            // ST≈òEDA (day: 3)
            { day: 3, timeFrom: '08:00', timeTo: '15:15', subject: 'Ov', color: '#00bfff' },
            
            // ƒåTVRTEK (day: 4)
            { day: 4, timeFrom: '07:40', timeTo: '08:25', subject: 'ƒåj', color: '#ff8c00' },
            { day: 4, timeFrom: '08:35', timeTo: '09:20', subject: 'M', color: '#ffd700' },
            { day: 4, timeFrom: '08:55', timeTo: '09:40', subject: 'Obv', color: '#ff4444' },
            { day: 4, timeFrom: '09:40', timeTo: '10:25', subject: 'T', color: '#9acd32' },
            { day: 4, timeFrom: '10:00', timeTo: '10:45', subject: 'ML', color: '#da70d6' },
            { day: 4, timeFrom: '10:35', timeTo: '11:20', subject: 'OK', color: '#808080' },
            { day: 4, timeFrom: '10:55', timeTo: '11:40', subject: 'tv', color: '#32cd32' },
            { day: 4, timeFrom: '11:25', timeTo: '12:10', subject: 'SZ', color: '#ba55d3' },
            { day: 4, timeFrom: '11:50', timeTo: '12:35', subject: 'tv', color: '#32cd32' },
            { day: 4, timeFrom: '13:25', timeTo: '14:10', subject: 'T', color: '#9acd32' },
            { day: 4, timeFrom: '14:20', timeTo: '15:05', subject: 'I', color: '#cd853f' },
            
            // P√ÅTEK (day: 5)
            { day: 5, timeFrom: '08:00', timeTo: '08:45', subject: 'M', color: '#ffd700' },
            { day: 5, timeFrom: '08:55', timeTo: '09:40', subject: 'ƒåj', color: '#ff8c00' }
        ];*/
        
        const days = ['Nedƒõle', 'Pondƒõl√≠', '√öter√Ω', 'St≈ôeda', 'ƒåtvrtek', 'P√°tek', 'Sobota'];
        
        // Cache syst√©m
        let cache = {
            timeString: '',
            dateString: '',
            lessonSubject: null,
            currentDay: -1,
            currentMinute: -1
        };
        
        // DOM elementy - cachovan√© pro rychl√Ω p≈ô√≠stup
        const elements = {
            time: document.getElementById('time'),
            date: document.getElementById('date'),
            lessonBox: document.getElementById('lessonBox')
        };
        
        // P≈ôedpoƒç√≠t√°n√≠ rozvrhu
        const scheduleOptimized = schedule.map(lesson => {
            const [startHour, startMin] = lesson.timeFrom.split(':').map(Number);
            const [endHour, endMin] = lesson.timeTo.split(':').map(Number);
            return {
                ...lesson,
                startMinutes: startHour * 60 + startMin,
                endMinutes: endHour * 60 + endMin
            };
        });
        
        // Seskupen√≠ podle dn√≠
        const scheduleByDay = {};
        scheduleOptimized.forEach(lesson => {
            if (!scheduleByDay[lesson.day]) {
                scheduleByDay[lesson.day] = [];
            }
            scheduleByDay[lesson.day].push(lesson);
        });
        
        // RequestAnimationFrame handler
        let animationFrameId = null;
        let lastFrameTime = 0;
        const FRAME_INTERVAL = 1000; // Aktualizace ka≈ædou sekundu

        // Optimalizovan√° aktualizace ƒçasu
        function updateTime(timestamp) {
            // Throttling - aktualizuj pouze ka≈ædou sekundu
            if (timestamp - lastFrameTime < FRAME_INTERVAL) {
                animationFrameId = requestAnimationFrame(updateTime);
                return;
            }
            
            lastFrameTime = timestamp;
            
            const now = new Date();
            const hours = String(now.getHours()).padStart(2, '0');
            const minutes = String(now.getMinutes()).padStart(2, '0');
            const seconds = String(now.getSeconds()).padStart(2, '0');
            
            const timeString = `${hours}:${minutes}:${seconds}`;
            
            // Aktualizuj ƒças pouze kdy≈æ se zmƒõn√≠
            if (timeString !== cache.timeString) {
                elements.time.textContent = timeString;
                cache.timeString = timeString;
            }
            
            // Aktualizuj datum pouze kdy≈æ se zmƒõn√≠ den
            const currentDay = now.getDay();
            if (currentDay !== cache.currentDay) {
                const dayName = days[currentDay];
                const date = now.getDate();
                const month = now.getMonth() + 1;
                const year = now.getFullYear();
                const dateString = `${dayName}, ${date}.${month}.${year}`;
                
                elements.date.textContent = dateString;
                cache.dateString = dateString;
                cache.currentDay = currentDay;
            }
            
            // Aktualizuj hodinu pouze kdy≈æ se zmƒõn√≠ minuta
            const currentMinute = now.getHours() * 60 + now.getMinutes();
            if (currentMinute !== cache.currentMinute || cache.lessonSubject === null) {
                updateCurrentLesson(now, currentDay, currentMinute);
                cache.currentMinute = currentMinute;
            }
            
            // Pokraƒçuj v animaƒçn√≠ smyƒçce
            animationFrameId = requestAnimationFrame(updateTime);
        }

        // Debounced DOM update pro hodinu
        let lessonUpdateTimeout = null;
        
        function updateCurrentLesson(now, currentDay, currentTime) {
            // Pou≈æij p≈ôedp≈ôipraven√Ω rozvrh
            const todayLessons = scheduleByDay[currentDay] || [];
            
            let currentLesson = null;
            
            // Rychl√© hled√°n√≠ s p≈ôedpoƒç√≠tan√Ωmi hodnotami
            for (let i = 0; i < todayLessons.length; i++) {
                const lesson = todayLessons[i];
                if (currentTime >= lesson.startMinutes && currentTime < lesson.endMinutes) {
                    currentLesson = lesson;
                    break;
                }
            }
            
            const newLessonSubject = currentLesson ? currentLesson.subject : null;
            
            // P≈ôekresli pouze kdy≈æ se hodina zmƒõnila
            if (newLessonSubject !== cache.lessonSubject) {
                // Debouncing - zpo≈ædƒõn√≠ pro plynulej≈°√≠ aktualizaci
                clearTimeout(lessonUpdateTimeout);
                lessonUpdateTimeout = setTimeout(() => {
                    updateLessonDisplay(currentLesson);
                    cache.lessonSubject = newLessonSubject;
                }, 50);
            }
        }
        
        // Separovan√° funkce pro aktualizaci displeje
        function updateLessonDisplay(lesson) {
            const box = elements.lessonBox;
            
            if (lesson) {
                box.style.borderColor = lesson.color;
                box.innerHTML = `
                    <div class="lesson-name" style="color: ${lesson.color}">${lesson.subject}</div>
                    <div class="lesson-time">${lesson.timeFrom} - ${lesson.timeTo}</div>
                `;
            } else {
                box.style.borderColor = 'rgba(255, 255, 255, 0.2)';
                box.innerHTML = '<div class="no-lesson">üìÖ ≈Ω√°dn√° hodina</div>';
            }
        }

        // Detekce viditelnosti str√°nky - pozastav√≠ aktualizace kdy≈æ nen√≠ vidƒõt
        document.addEventListener('visibilitychange', () => {
            if (document.hidden) {
                // Str√°nka skryt√° - zru≈° animaci
                if (animationFrameId) {
                    cancelAnimationFrame(animationFrameId);
                    animationFrameId = null;
                }
            } else {
                // Str√°nka viditeln√° - obnov animaci
                if (!animationFrameId) {
                    animationFrameId = requestAnimationFrame(updateTime);
                }
                // Okam≈æit√° aktualizace p≈ôi n√°vratu
                cache.currentMinute = -1;
            }
        });

        // Cleanup p≈ôi zav≈ôen√≠ str√°nky
        window.addEventListener('beforeunload', () => {
            if (animationFrameId) {
                cancelAnimationFrame(animationFrameId);
            }
            clearTimeout(lessonUpdateTimeout);
        });

        // Inicializace
        updateTime(0);
        animationFrameId = requestAnimationFrame(updateTime);
        
        // Performance monitoring (pouze pro debug)
        let frameCount = 0;
        let lastFpsUpdate = Date.now();
        
        function monitorPerformance() {
            frameCount++;
            const now = Date.now();
            if (now - lastFpsUpdate > 5000) {
                const fps = Math.round((frameCount / 5) * 10) / 10;
                document.getElementById('perfMode').textContent = `‚ö° VARIANTA B | ${fps} FPS`;
                frameCount = 0;
                lastFpsUpdate = now;
            }
            requestAnimationFrame(monitorPerformance);
        }
        
        monitorPerformance();
    </script>
</body>
</html>
